(function(e,d){var b,c,a;b='<div class="color-palettes"></div>';c=".color-palettes {display:block; position:relative;}.color-palettes, .color-palettes * {-moz-box-sizing: content-box; -web-box-sizing:content-box; box-sizing: content-box;}input+.color-palettes {margin-top:4px;}.color-palettes .color-palettes-item {border-radius:3px;box-shadow:inset 0 0 5px rgba(0,0,0,.4);height:100%;float:left;margin: 0px 2px 5px 2px;} .color-palettes .color-palettes-item span {width: 50%; height: 100%; display: block; margin-left: 50%; border-top-right-radius: 3px; border-bottom-right-radius: 3px; box-shadow:inset -1px 0px 5px 0px rgba(0,0,0,.3);} .color-palettes-border {border-radius: 3px; border: 1px solid #aaa; width: 200px; background-color: #fff;}.color-palettes-container {position:absolute;top:0;right:0;left:0;bottom:0}.color-palettes-border .color-palettes-container{top:10px;right:10px;left:9px;bottom:10px}";a={options:{color:false,hide:true,border:true,target:false,width:200,palettes:true,},_color:"#ffffff",_palettes:["#000","#ffffff","#d33","#d93","#ee2","#81d742","#1e73be","#8224e3"],_initiated:false,_create:function(){var g=this,h=g.element,f=g.options.color||h.val();g._color=h.val();if(h.is("input")){if(g.options.target){g.palette=e(b).appendTo(g.options.target)}else{g.palette=e(b).insertAfter(h)}g._addInputListeners(h)}else{h.append(b);g.palette=h.find(".color-palettes")}g._addColorPalettes();if(g.options.hide){g.palette.hide()}if(g.options.border){g.palette.addClass("color-palettes-border")}g._paletteListeners();g.active="external";g._dimensions();g._change()},_addColorPalettes:function(){var i=e('<div class="color-palettes-container" />'),h=e('<a class="color-palettes-item" tabindex="0" />'),f=e('<a class="color-palettes-item" tabindex="0"><span/></a>'),g=e.isArray(this.options.palettes)?this.options.palettes:this._palettes;if(this.palette.find(".color-palettes-container").length){i=this.palette.find(".color-palettes-container").detach().html("")}e.each(g,function(m,n){var k=n.split("/");if(k.length>1){var l=k[0];var j=k[1];f.clone().data("color",n).data("multicolor",n).css("backgroundColor",l).appendTo(i).height(10).width(10).find("span").css({backgroundColor:j})}else{h.clone().data("color",n).css("backgroundColor",n).appendTo(i).height(10).width(10)}});this.palette.append(i)},_dimensions:function(l){var o=this;var g=o.options;var i="100%";var h=20;var m=g.border?(g.width-h-1):(g.width-1);var j=e.isArray(g.palettes)?g.palettes.length:o._palettes.length;var k;var n;var f;if(l){o.palette.css({width:"",height:""})}i=m*(parseFloat(i)/100);boxHeight=g.border?i+h:i;o.palette.css({width:g.width,height:boxHeight});palettesPerLine=7;k=4;f=i-(palettesPerLine*k);n=f/palettesPerLine;o.palette.find(".color-palettes-item").each(function(p){var q=(p===0)?0:k;e(this).css({width:n,height:n})})},_addInputListeners:function(g){var f=this,h=100,i=function(k){var j=g.val();var l=g.val().replace("/^#/","");g.removeClass("color-palettes-error");if(j.error){if(l!==""){g.addClass("color-palettes-error")}}else{if(j.toString()!==f._color.toString()){if(!(k.type==="keyup"&&l.match(/^[0-9a-fA-F]+$/))){f._setOption("color",j.toString())}}}};g.on("change",i).on("keyup",f._debounce(i,h));if(f.options.hide){g.one("focus",function(){f.show()})}},_paletteListeners:function(){var f=this;f.palette.find(".color-palettes-container").on("click.palette",".color-palettes-item",function(){f._color=e(this).data("color");f.active="external";f._change()}).on("keydown.palette",".color-palettes-item",function(g){if(!(g.keyCode===13||g.keyCode===32)){return true}g.stopPropagation();e(this).click()})},_setOption:function(k,l){var h=this,j=h.options[k],g=false,f,i,m;h.options[k]=l;switch(k){case"color":l+""+l;f=l.replace(/^#/,"");i=l;if(i.error){h.options[k]=j}else{h._color=i;h.options.color=h.options[k]=h._color.toString();h.active="external";h._change()}break;case"palettes":g=true;if(l){h._addColorPalettes()}else{h.palette.find(".color-palettes-container").remove()}if(!j){h._paletteListeners()}break;case"width":g=true;break;case"border":g=true;m=l?"addClass":"removeClass";h.palette[m]("color-palettes-border");break}if(g){h._dimensions(true)}},destroy:function(){e.Widget.prototype.destroy.call(this)},_change:function(){var g=this,f=this._color;g.options.color=g._color.toString();if(g._initiated){g._trigger("change",{type:g.active},{color:g._color})}if(g.element.is(":input")&&!g._color.error){g.element.removeClass("color-palettes-error");if(g.element.val()!==g._color.toString()){g.element.val(g._color.toString())}}g._initiated=true;g.active=true},_debounce:function(h,j,g){var i,f;return function(){var n=this,m=arguments,l,k;l=function(){i=null;if(!g){f=h.apply(n,m)}};k=g&&!i;clearTimeout(i);i=setTimeout(l,j);if(k){f=h.apply(n,m)}return f}},show:function(){this.palette.show()},hide:function(){this.palette.hide()},toggle:function(){this.palette.toggle()},color:function(f){if(f===true){return this._color.clone()}else{if(f===d){return this._color.toString()}}this.option("color",f)}};e.widget("ui.colorpalettes",a);e('<style id="color-palettes-css">'+c+"</style>").appendTo("head")}(jQuery));